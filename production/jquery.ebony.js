!function(t,e){"use strict";e.jqEbonyOptions={opacity:.7,zIndex:99999,escapeCloses:!0,clickCloses:!0,clickCloseArea:null,callbackClose:null,callbackCloseBefore:null,callbackOpen:null,animationSpeed:0,color:[0,0,0]};var n=function(t,n){this.layout=null,this.element=n,this.options=e.extend(e.jqEbonyOptions,t||{})};n.prototype={getLayout:function(){return this.layout},getIndexZ:function(){return parseInt(e("body").data("jqEbony")||this.getOptions().zIndex,10)},getOptions:function(){return this.options},getElement:function(){return this.element},setIndexZ:function(t){return e("body").data("jqEbony",t),this},setLayout:function(t){return this.layout=t,this},hasLayout:function(){return!!this.layout},open:function(){if(this.hasLayout())return this;this.setLayout(this.getDefaultLayout()),this._setListeners(),this.getElement().wrapAll(this.getLayout()),this._transform().setIndexZ(this.getIndexZ()+1);var t=this;return this.getElement().hide().parent().fadeIn(this.getOptions().animationSpeed,function(){t.getElement().css("z-index",t.getIndexZ()).fadeIn(parseInt(t.getOptions().animationSpeed/2,10),function(){e.isFunction(t.getOptions().callbackOpen)&&t.getOptions().callbackOpen.call(t)})}),this},close:function(){if(!this.hasLayout())return this;var t=this,n=this.getElement();return e.isFunction(this.getOptions().callbackCloseBefore)&&this.getOptions().callbackCloseBefore(n),n.parent().fadeOut(this.getOptions().animationSpeed,function(){n.unwrap(),t._revert(),t.setLayout(null),e.isFunction(t.getOptions().callbackClose)&&t.getOptions().callbackClose.call(t)}),this},getDefaultLayout:function(){var t=[];return t.push(this.getOptions().color),t.push(this.getOptions().opacity),e("<div />").addClass("jqEbony").css({display:"none",position:"fixed",right:0,top:0,left:0,bottom:0,overflow:"auto","z-index":this.getIndexZ(),background:"rgba("+t.join(",")+")"})},_setListeners:function(){var n=this;if(this.options.escapeCloses&&(e(t).one("keyup.jqEbony",function(t){return 27===(t.keyCode||t.which)?(t.stopImmediatePropagation(),n.close()):void 0}),e._data(t,"events").keyup.unshift(e._data(t,"events").keyup.pop())),this.options.clickCloses){var i=this.getElement().parent();null!==this.getOptions().clickCloseArea&&(i=e(this.getOptions().clickCloseArea)),this.getElement().bind("click.jqEbony",function(t){var s=e(t.target);e(">*",i).each(function(){return t.target===this||e(this).is("script")||e(this).is("style")||!s.closest("html",this).length?void 0:n.close()})})}return this},_transform:function(){var t=this.getElement(),n=e("body"),i=e("html"),s={outerWidth:n.outerWidth(!0),marginRight:parseInt(e("body").css("margin-right"),10),scrollTop:i.scrollTop()};return t.data("jqEbony",this),this.getLayout().data("jqEbonyData",{element:{position:t.css("position"),display:t.css("display"),visibility:t.css("visibility")},html:{overflow:e("html").css("overflow-y")},body:{"margin-right":e("body").css("margin-right")}}),i.css("overflow","hidden"),n.css("margin-right",n.outerWidth(!0)-s.outerWidth+s.marginRight),i.scrollTop(s.scrollTop),this},_revert:function(){if(this.setIndexZ(this.getIndexZ()-1),!this.getLayout().data("jqEbonyData"))return this;var t=this.getLayout(),n=e("html").scrollTop();return e("div.jqEbony").length||(e("body").css(t.data("jqEbonyData").body),e("html").css(t.data("jqEbonyData").html).scrollTop(n)),this.getElement().css(t.data("jqEbonyData").element).removeData("jqEbonyData").removeData("jqEbony"),this}},e.fn.jqEbony=function(t){return this.data("jqEbony")||new n(t,e(this))}}(document,jQuery);