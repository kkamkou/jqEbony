!function(a,b){"use strict";b.jqEbonyOptions={opacity:.7,zIndex:99999,escapeCloses:!0,clickCloses:!0,clickCloseArea:null,callbackClose:null,callbackOpen:null,animationSpeed:0,color:[0,0,0]};var c=function(a,c){this.layout=null,this.element=c,this.options=b.extend(b.jqEbonyOptions,a||{})};c.prototype={getLayout:function(){return this.layout},getIndexZ:function(){return parseInt(b("body").data("jqEbony")||this.getOptions().zIndex,10)},getOptions:function(){return this.options},getElement:function(){return this.element},setIndexZ:function(a){return b("body").data("jqEbony",a),this},setLayout:function(a){return this.layout=a,this},hasLayout:function(){return!!this.layout},open:function(){if(this.hasLayout())return this;this.setLayout(this.getDefaultLayout()),this._setListeners(),this.getElement().wrapAll(this.getLayout()),this._transform().setIndexZ(this.getIndexZ()+1);var a=this;return this.getElement().parent().fadeIn(this.getOptions().animationSpeed,function(){a.getElement().css("z-index",a.getIndexZ()).fadeIn(a.getOptions().animationSpeed,function(){"function"==typeof a.getOptions().callbackOpen&&a.getOptions().callbackOpen.call(a)})}),this},close:function(){if(!this.hasLayout())return this;var a=this;return this.getElement().parent().fadeOut(this.getOptions().animationSpeed,function(){a.getElement().unwrap(),a._revert(),a.setLayout(null),"function"==typeof a.getOptions().callbackClose&&a.getOptions().callbackClose.call(a)}),this},getDefaultLayout:function(){var a=[];return a.push(this.getOptions().color),a.push(this.getOptions().opacity),b("<div />").addClass("jqEbony").css({display:"none",position:"fixed",right:0,top:0,left:0,bottom:0,overflow:"auto","z-index":this.getIndexZ(),background:"rgba("+a.join(",")+")"})},_setListeners:function(){var c=this;if(this.options.escapeCloses&&(b(a).one("keyup.jqEbony",function(a){return 27===(a.keyCode||a.which)?(a.stopImmediatePropagation(),c.close()):void 0}),b._data(a,"events").keyup.unshift(b._data(a,"events").keyup.pop())),this.options.clickCloses){var d=this.getElement().parent();null!==this.getOptions().clickCloseArea&&(d=b(this.getOptions().clickCloseArea)),this.getElement().bind("click.jqEbony",function(a){var e=b(a.target);b(">*",d).each(function(){return a.target===this||b(this).is("script")||b(this).is("style")||!e.closest("html",this).length?void 0:c.close()})})}return this},_transform:function(){var a=this.getElement(),c=b("body"),d=b("html"),e={outerWidth:c.outerWidth(!0),marginRight:parseInt(b("body").css("margin-right"),10),scrollTop:d.scrollTop()};return a.data("jqEbony",this),this.getLayout().data("jqEbonyData",{element:{position:a.css("position"),display:a.css("display"),visibility:a.css("visibility")},html:{overflow:b("html").css("overflow-y")},body:{"margin-right":b("body").css("margin-right")}}),d.css("overflow","hidden"),c.css("margin-right",c.outerWidth(!0)-e.outerWidth+e.marginRight),d.scrollTop(e.scrollTop),this},_revert:function(){if(this.setIndexZ(this.getIndexZ()-1),!this.getLayout().data("jqEbonyData"))return this;var a=this.getLayout(),c=b("html").scrollTop();return b("div.jqEbony").length||(b("body").css(a.data("jqEbonyData").body),b("html").css(a.data("jqEbonyData").html).scrollTop(c)),this.getElement().css(a.data("jqEbonyData").element).removeData("jqEbonyData").removeData("jqEbony"),this}},b.fn.jqEbony=function(a){return this.data("jqEbony")||new c(a,b(this))}}(document,jQuery);
